(function(){var d,e;Array.prototype.type="JList";e=function(){function c(){this.value=null}c.prototype.toString=function(){return"()"};c.prototype.type="Nil";return c}();d=function(){return function(){}}();d.Boolean=function(){function c(b){this.value=b}c.prototype.toString=function(){return this.value?"#t":"#f"};c.prototype.type="Boolean";return c}();d.Cons=function(){function c(b,a){this.first=b;this.rest=a}c.prototype.toString=function(){return"'("+this.first.toString()+" . "+this.rest.toString()+
")"};c.prototype.type="Cons";return c}();d.False=new d.Boolean(!1);d.Nil=new e;d.Number=function(){function c(b){this.value=b}c.prototype.toString=function(){return""+this.value};c.prototype.valueOf=function(){return this.value};c.prototype.type="Number";return c}();d.Procedure=function(c,b){b.toString=function(){return"#<procedure:"+c+">"};b.type="Procedure";return b};d.Symbol=function(){function c(b){this.value=""+b}c.prototype.toString=function(){return"'"+this.value};c.prototype.type="Symbol";
return c}();d.True=new d.Boolean(!0);window.Lisp=d}).call(this);(function(){var d,e,c,b;d={"+":new Lisp.Procedure("+",function(a){return a.reduce(function(a,b){return new Lisp.Number(a.value+b.value)})}),"-":new Lisp.Procedure("-",function(a){return a.reduce(function(a,b){return new Lisp.Number(a.value-b.value)})}),"*":new Lisp.Procedure("*",function(a){return a.reduce(function(a,b){return new Lisp.Number(a.value*b.value)})}),"/":new Lisp.Procedure("/",function(a){return a.reduce(function(a,b){return new Lisp.Number(a.value/b.value)})}),">":new Lisp.Procedure(">",
function(a){return a[0]>a[1]?Lisp.True:Lisp.False}),">=":new Lisp.Procedure(">=",function(a){return a[0]>=a[1]?Lisp.True:Lisp.False}),"<":new Lisp.Procedure("<",function(a){return a[0]<a[1]?Lisp.True:Lisp.False}),"<=":new Lisp.Procedure("<=",function(a){return a[0]<=a[1]?Lisp.True:Lisp.False}),"eq?":new Lisp.Procedure("eq?",function(a){return"Number"===a[0].type?a[0].value===a[1].value?Lisp.True:Lisp.False:a[0]===a[1]?Lisp.True:Lisp.False}),cons:new Lisp.Procedure("cons",function(a){return new Lisp.Cons(a[0],
a[1])}),first:new Lisp.Procedure("first",function(a){return a[0].first}),rest:new Lisp.Procedure("rest",function(a){return a[0].rest})};e=function(){function a(a,b,c){var d,e;null==a&&(a=[]);null==b&&(b=[]);this.parent=null!=c?c:null;c=0;for(e=a.length;c<e;c++)d=a[c],this[d.value]=b[c]}a.prototype.find=function(a){return a in this?this:this.parent.find(a)};a.prototype.updateValues=function(a){var b,c,d;d=[];for(b in a)c=a[b],d.push(this[b]=c);return d};return a}();b=new e;b.updateValues(d);c=function(a,
f){var d,g,i,j,h,k,l;null==f&&(f=b);if("JList"===a.type)switch(a[0].value){case "define":return h=a[1],g=a[2],"JList"===h.type?(d=h.shift(),f[d.value]=new Lisp.Procedure(d.value,function(a){return c(g,new e(h,a,f))})):f[h.value]=c(g,f);case "lambda":return k=a[1],g=a[2],new Lisp.Procedure("lambda",function(a){return c(g,new e(k,a,f))});case "if":return j=a[1],i=a[2],d=a[3],g=c(j,f)===Lisp.True?i:d,c(g,f);default:return d=function(){var b,d,e;e=[];b=0;for(d=a.length;b<d;b++)l=a[b],e.push(c(l,f));return e}(),
i=d.shift(),i(d)}else return"Symbol"===a.type?f.find(a.value)[a.value]:a};window.evalExpression=c;window.globalEnvironment=b}).call(this);(function(){var d,e,c;e=function(b){var a;a=b.shift();if("("===a){for(a=[];")"!==b[0];)a.push(e(b));b.shift();return a}if("'("===a){for(a=[];")"!==b[0];)a.push(e(b));b.shift();return d(a)}return c(a)};c=function(b){var a;if("true"===b)return Lisp.True;if("false"===b)return Lisp.False;if("nil"===b)return Lisp.Nil;a=Number(b.replace(/^'/,""));return isNaN(a)?new Lisp.Symbol(b.replace(/^'/,"")):new Lisp.Number(a)};d=function(b){return 0===b.length?Lisp.Nil:new Lisp.Cons(b.shift(),d(b))};window.tokenize=
function(b){var a,f,c,d,b=b.replace(/\(/g," ( "),b=b.replace(/\)/g," ) "),b=b.replace(/'\s+\(/g,"'(");a=b.split(" ");d=[];f=0;for(c=a.length;f<c;f++)b=a[f],""!==b&&d.push(b);return d};window.parseTokens=e}).call(this);(function(){var d,e,c,b,a;window.onload=function(){var a;a=document.getElementById("inputArea");a.onkeydown=c;a.onkeyup=b;a.focus();return a.setSelectionRange(2,2)};d=[];a=!1;c=function(b){var c;a=!1;c=document.getElementById("inputArea");if(13===b.keyCode)if(b=c.value.split("\n"),b=b[b.length-1],b=b.replace("$ ",""),"clear"===b)c.value="";else if(d.push(b+" "),b=d.reduce(function(a,b){return a+b}),e(b))return b=tokenize(b),b=parseTokens(b),console.log(b),b=evalExpression(b),console.log(b),null!=
b&&(c.value+="\n"+b.toString()),d=[],a=!0};b=function(b){var c;c=document.getElementById("inputArea");if(13===b.keyCode&&a)return c.value+="$ "};e=function(a){var b;b=a.split("(").length-1;a=a.split(")").length-1;return b===a}}).call(this);
